"""
使用说明 - 快速开始指南
"""

print("""
╔══════════════════════════════════════════════════════════════╗
║        🚀 V4: DINO蒸馏到YOLO11骨干网络 - 快速开始            ║
╚══════════════════════════════════════════════════════════════╝

📚 完整使用流程
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【步骤1】准备蒸馏数据（合并有标签+无标签图像）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  命令：
    python prepare_distill_data.py
  
  说明：
    - 自动合并 Data/dataset_no_noise_all（无灰尘图像）
    - 自动合并 Data/dataset_yolo（有灰尘图像）
    - 输出到 v4/distill_images/
    - 推荐数据量：5000-10000张
  
  清空数据（重新准备）：
    python prepare_distill_data.py --clean


【步骤2】DINO蒸馏预训练（需要GPU，耗时2-4小时）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  命令：
    python distill_pretrain.py
  
  说明：
    - 使用DINOv3-ViT-L/16作为教师模型
    - 蒸馏到YOLO11n骨干网络
    - 默认150轮训练
    - 输出：runs/distill/yolo11n_distilled.pt
  
  参数调整（修改 distill_config.py）：
    EPOCHS = 150          # 训练轮数
    BATCH_SIZE = 16       # 批次大小（根据显存调整）
    IMG_SIZE = 640        # 图像尺寸
  
  ⚠️ 注意事项：
    - 需要预先准备DINO模型文件：dinov3-vitl16.tar.gz
    - 显存不足时减小BATCH_SIZE（16→8→4）


【步骤3】使用蒸馏权重训练检测模型
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  命令：
    python train.py
  
  说明：
    - 自动检测并加载蒸馏权重
    - 若无蒸馏权重，则使用原始yolo11n.pt
    - 输出：best.pt（最佳检测模型）
  
  检查蒸馏权重：
    python train.py --check


【步骤4】测试模型性能
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  命令：
    python test.py
  
  说明：
    - 在测试集上评估mAP、Precision、Recall
    - 自动生成可视化图表



━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 常见问题 FAQ
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q1: 蒸馏数据需要标签吗？
A1: 不需要！蒸馏是无监督预训练，只要图像即可。

Q2: 有标签的灰尘图像和无标签的无灰尘图像都能用吗？
A2: 都可以用！建议全部使用，增加数据多样性。

Q3: 需要多少张图像？
A3: 最少1000张，推荐5000-10000张，越多效果越好。

Q4: 蒸馏需要多长时间？
A4: 视GPU性能和数据量而定，通常2-4小时（150轮）。

Q5: 显存不足怎么办？
A5: 减小BATCH_SIZE（16→8→4）或IMG_SIZE（640→512）。

Q6: 蒸馏效果如何？
A6: 预期：收敛速度提升20-30%，最终mAP提升2-5%。

Q7: 没有DINO模型能蒸馏吗？
A7: 可以！脚本会自动降级使用简化损失函数（效果略差）。

Q8: 可以中断后继续训练吗？
A8: 可以！使用检查点继续：
    - 修改distill_pretrain.py中的初始权重路径
    - 加载runs/distill/checkpoint_epochXX.pt


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📁 关键文件说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【核心脚本】
  prepare_distill_data.py  - 数据准备
  distill_pretrain.py      - 蒸馏预训练
  train.py                 - 检测训练
  test.py                  - 模型测试
  pred.py                  - 模型预测

【配置文件】
  distill_config.py        - 蒸馏超参数配置
  yolo11P.yaml            - YOLO11模型结构

【关键目录】
  distill_images/         - 蒸馏数据目录
  runs/distill/           - 蒸馏输出目录
  runs/detect/            - 检测训练输出
  runs/predict/           - 预测输出


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 预期效果对比
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  指标              | 无蒸馏  | DINO蒸馏 | 提升
  ─────────────────────────────────────────
  收敛轮数          | ~40     | ~30      | -25%
  训练时间          | 较长     | 较短     | -20%
  mAP50             | 基准值   | +2~5%    | ↑
  小目标检测        | 基准值   | +3~8%    | ↑↑
  泛化能力          | 基准值   | 增强     | ↑


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📧 技术支持
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  遇到问题？查看README.md或提交Issue


╔══════════════════════════════════════════════════════════════╗
║                   🎉 祝训练顺利！                             ║
╚══════════════════════════════════════════════════════════════╝
""")
